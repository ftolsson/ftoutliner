<p class="headline">Welcome to FTOutliner</p>
<div id = "main">
	
		<strong>First of all, a message to the user.</strong><br/>&nbsp;
		Thank you for taking a look at FTOutliner! It seems that this is the first time you're using it -- ever, on this computer, or after the last update -- so for that reason, here are some quick things I'd like to tell you before we get started!<br/><br/>
		<strong>1. FTOutliner is a work in progress. Aren't we all.</strong><br/>&nbsp;
		First of all, I'm not a coder. I'm a screenwriter. One who couldn't find a visual outlining tool that made me happy. And so, long story short, when Beat allowed external plugins, I made this for myself. As a side effect, I also made it for you.<br/>
		Over the couple of years that FTOutliner has existed, I've become marginally less sucky at coding. I'm currently trying to rewrite the entire codebase to eliminate the worst beginner mistakes. 
		But it's still not my day job, so not only will it take some time to get it to where I want it to be, but we may also well find that I introduce new bugs as I go along.<br/>
		In some ways, FTOutliner is a work in regress. It's the Benjamin Button of software. Let's hope it doesn't die in the end. But on that note:<br/><br/>
		<strong>2. Bugs will happen. Please report them.</strong><br/>&nbsp;
		I am slowly transforming the entire code from the tangled spaghetti that remains from my first coding steps, into what is hopefully at least some shorter, less clunky, kind of pasta.<br/>
		The goal is a more reliable plugin — but the journey there is still ongoing. 
		<br/><br/>
		For that reason, there is a new menu item in the Settings Menu (the gear icon in the bottom left corner) that allows you to report bugs. It takes you to my gitHub issues page, where you can post what you encounter. Please do — so we can gradually improve this plugin together!
		<br/><br/>
		<strong>3. What has changed?</strong><br/>&nbsp;
		There are a lot of new features in this version of FTOutliner. I've tried to make them as intuitive as possible, but there are a few things that might be a little confusing at first. I've made a video that explains the new features, and I recommend you watch it. You can find it in the Help Menu (the question mark icon in the bottom left corner).<br/><br/>
		<strong>4. What's next?</strong><br/>&nbsp;
		There are still a lot of things that I want to add to FTOutliner. I'm working on them, and I'll release them as soon as they're ready. If you have any suggestions, please let me know!<br/><br/>
	<!--hr-->
	<ul>
	<!--strong><br/>Behavior Settings</strong><br/-->&nbsp;
	<li onclick="toggleThis('neverShowAgain', 'buttonFor-neverShowAgain')"> 
		<input id="buttonFor-neverShowAgain" type="checkbox">
		<label for="buttonFor-neverShowAgain">Don't ever show this dialog again, goddamit!<span class="shortcut" style="float:right"></span></label>
		<span class="explanation">Unless there's something new to say that's really really important.<br/>In which case sure, fine, go ahead.</span>
	</li>
	<!--li onclick="toggleThis('clickingSelectsInEditor', 'buttonFor-clickingSelectsInEditor')">
		<input id="buttonFor-clickingSelectsInEditor" type="checkbox">
		<label for="buttonFor-clickingSelectsInEditor">Clicking scenes in FTOutliner selects text in main editor<span class="shortcut" style="float:right"></span></label>
		<span class="explanation">When OFF, the same can be temporarily achieved with ctrl+alt+cmd+click.</span>
	</li>
	<br/>
	<li  onclick="toggleThis('warningsAreOn', 'buttonFor-warningsAreOn', true)">
		<input id="buttonFor-warningsAreOn" type="checkbox">
		<label for="buttonFor-warningsAreOn">Disable Warning Messages<span class="shortcut" style="float:right">^P</span></label>
	</li>
	<li  onclick="toggleThis('realTimeIsOn', 'buttonFor-realTimeIsOn', true)">
		<input id="buttonFor-realTimeIsOn" type="checkbox">
		<label for="buttonFor-realTimeIsOn">Disable Real Time Updating	<span class="shortcut" style="float:right">^P</span></label><br/>
		<class="explanation">This is generally not recommended</class>
	</li-->
	</ul>

	<p><br/></p>
	<div class="dialogBottomButtonRow">
		<!-- <button class="generalButtonStyle" onclick="for (butn of $$('#advancedSettings input')){if(butn.checked){butn.click()}}">Revert to defaults</button> -->
		<button class="generalButtonStyle" onclick="Beat.call('Beat.custom.closeSecondWindow()')">Close</button>
	</div>
</div>

<script>

	//STARTUP SEQUENCE:

	var userDefault = {}
	var documentSetting = {}
    
    Beat.callAndWait(() => {
        let ftoutlinerObject = Beat.getUserDefault("ftoutlinerObject")
        return(ftoutlinerObject)
    })
    .then(
        response => { userDefault = JSON.parse(response)
			
			//Apply the correct checkbox states on open:
			for ([key, value] of Object.entries(userDefault)){					
					let button = document.getElementById("buttonFor-" + key)
						if(button){ 
							if(value == true) button.setAttribute("checked", true) 
						}
				}
		},
        error => { console.log("Error retrieving userDefault") }
    )

    Beat.callAndWait(() => {
        let ftoutlinerObject = Beat.getDocumentSetting("ftoutlinerObject")
        return ftoutlinerObject
    	})
		.then(
			response => { documentSetting = JSON.parse(response)
		
				//Apply the correct checkbox states on open:
					for ([key, value] of Object.entries(documentSetting)){					
						let button = document.getElementById("buttonFor-" + key)
							if(button){ 
								if(value == true) button.setAttribute("checked", true) 
							}
					}
			},
			error => { console.log("Error retrieving documentSetting") }
		)


	//FUNCTIONS:

	function toggleThis(settingName, settingButton, invertSelection){

		documentSetting[settingName] = document.getElementById("buttonFor-" + settingName).checked

		let valueAsJSON = JSON.stringify(documentSetting[settingName])
			Beat.call(`	Beat.custom.sendToMain("${settingName}", ${valueAsJSON}, "documentSetting") `)

	}


</script>

<style>

    :root{

        --menu-background: hsla(25, 64%, 96%, 1.00);/* rgb(240, 240, 240); /*was 232*/
	    --menu-border-color: #c1c1c1;
	    --menu-color: rgb(233,233,233);
	    --menu-hover-color: #027aff;

    }

    @media (prefers-color-scheme: dark) {

        :root{

            --menu-background: hsla(25, 10%, 24%, 1.00);
            --menu-border-color: rgb(81,81,81);
            --menu-color: rgb(233,233,233);

            --inkOnPaper: 0, 0%, 100%;
            --paperBehindInk: 0, 0%, 0%;

        }
    }

    body{

        background-color: var(--menu-background);

        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        font-size: 13px;
        font-weight: normal;
        line-height: 18px;

    }

    li {

        list-style-type: none;
        padding-top: 3px;
		padding-left: 20px;
    }

	.shortcut {

		display: none;

	}

	.explanation {

		font-size: 11px;
		line-height: 14px;
		margin-left: 40px;
		margin-top: -2px;
		display: block;

		font-style: italic;
		opacity: 60%;

	}

	label:hover .shortcut {

		display: inline;

	}

	.dialogBottomButtonRow {

		position: absolute;
		bottom: 20px;
		right: 20px;

	}

	button{

		font-size: 13px;

	}

	button:hover{

		border: inherit !important;
		border-radius: inherit !important; 
		background-color: var(--menu-hover-color);
		color: white;
		/* pointer-events: none; */

	}

	hr {

		opacity: 50%;
		margin: 0 40px;
		mix-blend-mode: multiply;

	}

	ul {

		margin-top: 0px;
		margin-bottom: 0px;

	}


</style>
